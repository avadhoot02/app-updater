
<!DOCTYPE html>
<html>
<head>
    <title>App Updates</title>
    <!-- Bootstrap CSS link -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Font Awesome icons -->
 

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Custom CSS -->
    <style>
        body {
            background-color: #f0f0f0;
        }
         .container {
   	   max-width: 1000px;
    	   padding: 15px;
	}    

    .h1, h1{
        font-size: 1.2rem;
    }
        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .card-header {
           
            color: black; /* Blue */
            font-weight: bold;
            border-radius: 10px 10px 0 0;
            padding: 10px;
            text-align: center;
            
            border-radius: calc(0.25rem - 1px) calc(0.25rem - 1px) 0 0;
            background-color: #6ddfc6;
            border: black;
            /* display: flex; */
             align-items: center;
        }
        }
        .card-body {
            text-align: center;
        }
       .update-btn {
    
             margin-top: 10px;
             background-color: #11b0fc;
             color: #fff;
             border-color: #fca311;
             margin: 4px;
        } 
        .update-btn:hover {
            background-color: #e85d04; /* Darker orange on hover */
            border-color: #e85d04; /* Darker orange on hover */
        }
        .progress-container {
            margin-top: 20px;
            text-align: center;
        }
        .progress-bar {
            background-color: #fca311; /* Light orange */
        }
        pre {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 20px;
        }
        .icon {
            font-size: 35px;
            margin-right: 10px;
            vertical-align: middle;
        }
        .logo-img {
              width: 100px;
            height: 100px;
        }
        .icon-chrome {
                color: #0010cc;
        }
        .icon-firefox {
                color: #0010cc;
        }
        .updater-title {
           text-align: center;
           font-size: 24px;
           font-weight: bold;
           margin-bottom: 20px;
           background-color: #FFC107;
           border: black;
           border-radius: initial;
        }
      .card-header:first-child {
    border-radius: calc(0.25rem - 1px) calc(0.25rem - 1px) 0 0;
    background-color: #6ddfc6;
    border: black;
}
    </style>
</head>
<body>

    <div class="container mt-5">
        <div class="updater-title">Application Updater Interface </div>
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <!-- <div class="card-header"><i class="icon icon-chrome fab fa-chrome"></i> Update Google Chrome</div> -->
                    <div class="toggle-details">
                        <a href="javascript:void(0);" onclick="toggleUpdateDetails('ch-details', 'ch-info');">
                        <!-- <span class="toggle-text" style="display: flexbox; background-color: #6ddfc6; color: black; border-color: black; border-style:solid; border: width 1rem; ;">Show Details</span> -->
                          <!-- <span class="toggle-icon">*</span> -->
                          <div class="card-header"><i class="icon icon-chrome fab fa-chrome"></i> Update Google Chrome</div>

                          <button  type="button" id="ch-info"  class="btn btn-secondary btn-sm m-2  rounded-top" >+</button> 
                        </a>

                       </div>
                       <div class="card-body" id="ch-details" style="display: none; ">
                       
                        <div id="ch-circle" class="spinner-grow text-danger m-2" role="status" > </div> 
                          <!-- <div class="card-body"> -->
                        <button id="update-chrome" class="btn btn-primary update-btn">Update</button>
                        <div class="progress-container mt-3" style="display: none;">
                            <div id="chrome-progress" class="progress">
                                <!-- <div id="ch-pro" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> -->
                                <div id="ch-pro" class="progress-bar bg-warning text-dark" style="width: 0%">0%</div>


                            </div>
                        </div>
                        <pre id="chrome-output"></pre>
			<a button href="http://192.168.1.196/chrome-releases/" id="download-chrome" class="btn btn-primary update-btn">Download</button> </a>

                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <!-- <div class="card-header"><i class="icon icon-firefox fab fa-firefox"></i> Update Mozilla Firefox</div> -->
                    <div class="toggle-details">
                        <a href="javascript:void(0);" onclick="toggleUpdateDetails('firefox-details', 'ff-info');">
                        <!-- <span class="toggle-text" style="display: flexbox; background-color: #6ddfc6; color: black; border-color: black; border-style:solid; border: width 1rem; ;">Show Details</span> -->
                          <!-- <span class="toggle-icon">*</span> -->
                          <div class="card-header"><i class="icon icon-firefox fab fa-firefox"></i> Update Mozilla Firefox</div>

                          <button  type="button" id="ff-info"   class="btn btn-secondary btn-sm m-2   rounded-top" >+</button> </a>

                       </div>
                       <div class="card-body" id="firefox-details" style="display: none; ">
                        <div id="fr-circle" class="spinner-grow text-danger m-2" role="status" > </div> 

                    <!-- <div class="card-body"> -->
                        <button id="update-firefox" class="btn btn-primary update-btn">Update</button>
                        <div class="progress-container mt-3" style="display: none;">
                            <div id="firefox-progress" class="progress">
                                <div id="fr-pro" class="progress-bar bg-warning text-dark" style="width: 0%">0%</div>
                            </div>
                        </div>
                        <pre id="firefox-output"></pre>
			<a  <button href="http://192.168.1.196/firefox-releases/" id="download-firefox" class="btn btn-primary update-btn">Download</button> </a>

                    </div>
                </div>
            </div>
	 <div class="col-md-6">
                <div class="card">
                   
                    <!-- <div class="card-header"><i class="fas fa-citrix"></i>Update Vmware </div> -->
                    <div class="toggle-details">
                        <a href="javascript:void(0);" onclick="toggleUpdateDetails('vmware-details', 'vm-info');">
                        <!-- <span class="toggle-text" style="display: flexbox; background-color: #6ddfc6; color: black; border-color: black; border-style:solid; border: width 1rem; ;">Show Details</span> -->
                          <!-- <span class="toggle-icon">*</span> -->
                          <div class="card-header"> Update Vmware </div>

                          <button  type="button" id="vm-info"   class="btn btn-secondary btn-sm m-2"  >+</button> </a>

                       </div>
                    <div class="card-body" id="vmware-details" style="display: none; ">
   
                    <!-- <div class="card-body"> -->
                        <div id="vm-circle" class="spinner-grow text-danger m-2" role="status" > </div> 

                        <button id="update-vmware" class="btn btn-primary update-btn m-1">Update</button>
                        <div class="progress-container mt-3" style="display: none;">
                            <div id="vmware-progress" class="progress">
                                <div id="vm-pro" class="progress-bar bg-warning text-dark" style="width: 0%">0%</div>

                            </div>
                        </div>
                        <pre id="vmware-output"></pre>
                        <a  <button href="http://192.168.1.196/vmware-releases/" id="download-vmware" class="btn btn-primary update-btn">Download</button> </a>

                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card">
                    <!-- <div class="card-header"><i class="fas fa-citrix"></i>Update Citrix</div> -->

                                            <!-- Show/Hide link -->
                     <div class="toggle-details">
                         <a href="javascript:void(0);" onclick="toggleUpdateDetails('citrix-details', 'ctx-info');">
                         <!-- <span class="toggle-text" style="display: flexbox; background-color: #6ddfc6; color: black; border-color: black; border-style:solid; border: width 1rem; ;">Show Details</span> -->
                           <!-- <span class="toggle-icon">*</span> -->
                           <div class="card-header">Update Citrix</div>

                           <button  type="button" id="ctx-info"  class="btn btn-secondary btn-sm m-2 " >+</button> </a>

                        </div>

                         </a>
                    <div class="card-body" id="citrix-details" style="display: none; ">

                    <!-- <div class="card-body"> -->
                        <!-- <button id="update-ctx" class="btn btn-primary update-btn">Update</button> <br>  -->
                        <h1>Please Select Required Debian Packages To Update Citrix App</h1>
                        <!-- <label for="vmware-url">VMware Package Url:</label> <br>
                        <input type="text" id="vmware-url" name="vmware-url"><br>
                        <label for="usb-url">USB Package Url:</label> <br>
                        <input type="text" id="usb-url" name="usb-url"><br> -->
                        <label for="ctx-path">Select Latest icaclient .deb package from ~/Downloads/ :</label>
                        <input type="text" id="s1" readonly > <br>

                        <input type="file" class="mt-1 btn btn-sm btm" id="ctx-path" accept=".deb" onchange="displayFilePath(ic_file,ic_path)">
                        <br>
                        <label for="ctx-path">Select Latest ctx-usb .deb package from ~/Downloads/ :</label> <br>
                        <input type="text" id="s2" readonly>

                        <input type="file" class="mt-1 btn btn-sm btm" id="usb-path" accept=".deb" onchange="displayFilePath(usb_file,usb_path)">
                        <br>
                    
                        <div id="ct-circle" class="spinner-grow text-danger m-2" role="status" > </div> 

                        <button id="update-ctx" class="btn btn-primary update-btn m-2">Update</button> <br> 

                        <div class="progress-container mt-3" style="display: none;">
                            <div id="ctx-progress" class="progress">
                                <div id="ct-pro" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                        </div>
                        <pre id="ctx-output"></pre>
                        <a  <button href="http://192.168.1.196/citrix-releases/" id="download-ctx" class="btn btn-primary update-btn">Download</button> </a>

                    </div>
                </div>
            </div>
            </div>

    </div>
    </div>
    <!-- jQuery, Bootstrap JS, and SocketIO JS links -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    
    <script>

    function updateProgressBar(id,value) {
        const progressBar = document.getElementById(id);
        progressBar.style.width = value + '%';
        progressBar.innerHTML= value + '%';

        progressBar.setAttribute('aria-valuenow', progress);
    }
    

    function toggleUpdateDetails(id, link) {
    const details = document.getElementById(id);
    const linkText = document.getElementById(link);

    if (details.style.display === 'none') {
      details.style.display = 'block';
      linkText.innerHTML = 'x';
    } else {
      details.style.display = 'none';
      linkText.textContent = '+';
    }
  }

    const icPathInput = document.getElementById("ctx-path");
    const usbPathInput = document.getElementById("usb-path");
    const updateButton = document.getElementById("update-ctx");

    icPathInput.addEventListener("change", updateButtonVisibility);
    usbPathInput.addEventListener("change", updateButtonVisibility);
      
       
    function updateButtonVisibility() {
        const icFilePath = icPathInput.value;
        const usbFilePath = usbPathInput.value;
       
        if (icFilePath && usbFilePath) {
            updateButton.style.display = "block";
        } else {
            updateButton.style.display = "none";
        }
    }


        var ic_file='ctx-path'
        var ic_path='s1'
        var usb_file='usb-path'
        var usb_path='s2'

         function displayFilePath(a,b) {
            const input = document.getElementById(a);
            const filePathInput = document.getElementById(b);
            
            if (input.files && input.files[0]) {
                const file = input.files[0];
            
                const fileName = file.name;
                const extension = fileName.split('.').pop().toLowerCase();
                
                if (extension === 'deb') {
                    filePathInput.value = fileName;
                } else {
                    alert('Please select a .deb file.');
                    input.value = ''; // Clear the input field
                    filePathInput.value = ''; // Clear the displayed path
                }
            }
        }

        $(document).ready(function() {
            var socket = io.connect('http://' + document.domain + ':' + location.port);
               
           
            

           
              

            var dch = "download-chrome"
            var uch="update-chrome"
            var prech="chrome-output"
            
            
            var dff = "download-firefox"
            var uff = "update-firefox"
            var predff="firefox-output"
            
            var dctx = "download-ctx"
            var uctx = "update-ctx"
            var prectx = "ctx-output"

            var upvm ="update-vmware"
            var dvm = "download-vmware"
            var prevm = "vmware-output"

            hideElementById(dff);
            hideElementById(dch);
            hideElementById(dvm);
            hideElementById(dctx);
            hideElementById("ch-circle");
            hideElementById("fr-circle");
            hideElementById("vm-circle");
            hideElementById("ct-circle");





        // function checkPreTagForSuccessMessage(a,b,c) {
        // var preTag = document.getElementById(c);
        // changeInnerHTMLById(b, "Done updating");
        // showElementById(a);
        // }
                              
          function hideElementById(elementId) {
		  var element = document.getElementById(elementId);
 		  if (element) {
   			 element.style.display = "none";}
	           }

		 function changeInnerHTMLById(elementId, newInnerHTML) {
		  var element = document.getElementById(elementId);
  			if (element) {
 		   element.innerHTML = newInnerHTML;
           element.style.backgroundColor = "red";
           element.disabled = true;					    
 			 }
			}

		  function showElementById(elementId) {
 	          var element = document.getElementById(elementId);
 		 if (element) {
  		  element.style.display = "block"; // or any other suitable display value
  		    }
			}


            socket.on('chrome_output', function(data) {
                
                if (data.output.includes("ok")) {
                changeInnerHTMLById("update-chrome", "updated");
                document.getElementById("update-chrome").disabled = true;

	        var element = document.getElementById(uch).style.backgroundColor = "green";
                    showElementById(dch);

                    hideElementById("ch-circle");

                    updateProgressBar("ch-pro",100);

                }
                else if (data.output.includes("P-15")) {
            updateProgressBar("ch-pro",15);     
                }
                else if (data.output.includes("P-25")) {
            updateProgressBar("ch-pro",25);     
                }
                else if (data.output.includes("P-35")) {
            updateProgressBar("ch-pro",35);     
                }
                else if (data.output.includes("P-50")) {
            updateProgressBar("ch-pro",50);     
                }
            else if (data.output.includes("P-70")) {
            updateProgressBar("ch-pro",70);     
                }
                else if (data.output.includes("P-90")) {
            updateProgressBar("ch-pro",90);     
                }

            else{

            $('#chrome-output').append(data.output + '\n');
            }

               
            });
            
            socket.on('firefox_output', function(data) {
                if (data.output.includes("0xff")) {
                changeInnerHTMLById(uff, "updated");
	            var element = document.getElementById(uff).style.backgroundColor = "green";
                hideElementById("fr-circle");
                showElementById(dff);
                hideElementById("vm-circle");


                updateProgressBar("fr-pro",100);
            }
            else if (data.output.includes("P-15")) {
            updateProgressBar("fr-pro",15);     
                }
                else if (data.output.includes("P-25")) {
            updateProgressBar("fr-pro",25);     
                }
                else if (data.output.includes("P-35")) {
            updateProgressBar("fr-pro",35);     
                }
                else if (data.output.includes("P-50")) {
            updateProgressBar("fr-pro",50);     
                }
            else if (data.output.includes("P-70")) {
            updateProgressBar("fr-pro",70);     
                }
                else if (data.output.includes("P-90")) {
            updateProgressBar("fr-pro",90);     
                }

            else{

            $('#firefox-output').append(data.output + '\n');
            }
              
            });

            socket.on('vmware_output', function(data) {
                if (data.output.includes("ok")) {
                changeInnerHTMLById(upvm, "updated");
	            var element = document.getElementById(upvm).style.backgroundColor = "green";
                showElementById(dvm);
                hideElementById("vm-circle");     

                updateProgressBar("vm-pro",100);

                }
                else if (data.output.includes("P-15")) {
            updateProgressBar("vm-pro",15);     
                }
                else if (data.output.includes("P-25")) {
            updateProgressBar("vm-pro",25);     
                }
                else if (data.output.includes("P-35")) {
            updateProgressBar("vm-pro",35);     
                }
                else if (data.output.includes("P-50")) {
            updateProgressBar("vm-pro",50);     
                }
            else if (data.output.includes("P-70")) {
            updateProgressBar("vm-pro",70);     
                }
                else if (data.output.includes("P-90")) {
            updateProgressBar("vm-pro",90);     
                }

            else{

            $('#vmware-output').append(data.output + '\n');
            }

              
            });

             
            socket.on('ctx_output', function(data) {
                if (data.output.includes("ok")) {
                changeInnerHTMLById(uctx, "updated");
	        var element = document.getElementById(uctx).style.backgroundColor = "green";

                showElementById(dctx);
                hideElementById("ct-circle");     
                updateProgressBar("ct-pro",100);

                }     
            
            

               
                else if (data.output.includes("P-15")) {
            updateProgressBar("ct-pro",15);     
                }
                else if (data.output.includes("P-25")) {
            updateProgressBar("ct-pro",25);     
                }
                else if (data.output.includes("P-35")) {
            updateProgressBar("ct-pro",35);     
                }
                else if (data.output.includes("P-50")) {
            updateProgressBar("ct-pro",50);     
                }
            else if (data.output.includes("P-70")) {
            updateProgressBar("ct-pro",70);     
                }
                else if (data.output.includes("P-90")) {
            updateProgressBar("ct-pro",90);     
                }
                else if (data.output.includes("P-95")) {
            updateProgressBar("ct-pro",95);     
                }

            else{

            $('#ctx-output').append(data.output + '\n');
            }

              
            });

        
            $('#update-chrome').on('click', function() {
                $('.progress-container').show();
		    changeInnerHTMLById("update-chrome", "updating...");
		hideElementById("download-chrome");
        showElementById("ch-circle");
	        socket.emit('update_chrome');
            
            });

            $('#update-firefox').on('click', function() {
                $('.progress-container').show();
		     changeInnerHTMLById("update-firefox", "updating...");
             showElementById("fr-circle");

                 hideElementById("download-firefox");
                socket.emit('update_firefox');

                
            });

         
            $('#update-vmware').on('click', function() {
                $('.progress-container').show();
		    changeInnerHTMLById(upvm, "updating...");
                 hideElementById(dvm);
                 showElementById("vm-circle");

                socket.emit('update_vmware');
                
            });
              
          
            // var ctPath="ctx-path"
            // var usbPath="usb-path"
            // var s1='selected-file-path-1'
            // var s2 = 'selected-file-path-2'


    
        
            // var vmwareUrl = document.getElementById('vmware-url').value;
            // var usbUrl = document.getElementById('usb-url').value;
            var vmwareInput = document.getElementById('s1');
            var usbInput = document.getElementById('s2');
            var updateBtn = document.getElementById(uctx);
            updateBtn.style.display = 'none';             

            // vmwareInput.addEventListener('input', toggleUpdateButton);
            // usbInput.addEventListener('input', toggleUpdateButton);

            // function toggleUpdateButton() {
            // if (vmwareInput.value.trim() !== '' && usbInput.value.trim() !== '') {
            //     // updateBtn.removeAttribute('disabled');
            //     updateBtn.style.display = 'block';
            // } else {
            //     // updateBtn.setAttribute('disabled', true);
            //     updateBtn.style.display = 'none';
            //     }
            //     }
           

            $('#update-ctx').on('click', function() {
                $('.progress-container').show();
		     changeInnerHTMLById(uctx, "updating...");
                 hideElementById(dctx);
                 showElementById("ct-circle");

                // socket.emit('update_ctx');
            socket.emit('update_ctx', { vmwareUrl: icPathInput.value.split("\\").pop() , usbUrl:  usbPathInput.value.split("\\").pop() });  
            
           
            

            });





            
        });
    </script>
</body>
</html>


